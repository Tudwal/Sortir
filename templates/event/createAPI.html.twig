{% extends 'base.html.twig' %}

{% block title %}Nouvelle sortie
{% endblock %}

{% block body %}

	<div class="col-12 my-3">

		{{form_start(formulaire)}}

		<div class="col-2">
			{{form_errors(formulaire.name)}}
			{{form_errors(formulaire.startDateTime)}}
			{{form_errors(formulaire.endRegisterDate)}}
			{{form_errors(formulaire.duration)}}
			{{form_errors(formulaire.nbParticipantMax)}}
			{{form_errors(formulaire.details)}}
		</div>
		<fieldset>
			<legend>Créer une sortie</legend>

			<div class="d-flex">

				<div class="col-6">

					<div class="form-group row">

						<label for="select" class="col-4 col-form-label">
							{{form_label(formulaire.name)}}
						</label>
						<div class="col-6">
							{{form_widget(formulaire.name)}}
						</div>
					</div>
					<div class="form-group row">

						<label for="select" class="col-4 col-form-label">
							{{form_label(formulaire.startDateTime)}}
						</label>
						<div class="col-6">
							{{form_widget(formulaire.startDateTime)}}
						</div>
					</div>
					<div class="form-group row">
						<label for="select" class="col-4 col-form-label">
							{{form_label(formulaire.endRegisterDate)}}
						</label>
						<div class="col-6">
							{{form_widget(formulaire.endRegisterDate)}}
						</div>
					</div>
					<div class="form-group row">
						<label for="select" class="col-4 col-form-label">
							{{form_label(formulaire.nbParticipantMax)}}
						</label>
						<div class="col-6">
							{{form_widget(formulaire.nbParticipantMax)}}
						</div>
					</div>
					<div class="form-group row">
						<label for="select" class="col-4 col-form-label">
							{{form_label(formulaire.duration)}}
						</label>
						<div class="col-6">
							{{form_widget(formulaire.duration)}}
						</div>
					</div>


					<div class="form-group row">
						<label for="select" class="col-4 col-form-label">
							{{form_label(formulaire.details)}}
						</label>
						<div class="col-6">
							{{form_widget(formulaire.details)}}
						</div>
					</div>

				</div>

				<div class="col-6">
					<div class="form-group row">

						<label for="select" class="col-4 col-form-label">
							{{form_label(formulaire.campus)}}
						</label>
						<div class="col-6">
							{{form_widget(formulaire.campus)}}
						</div>
					</div>
					<div class="form-group row">
						<label for="select" class="col-4 col-form-label">
							Ville
						</label>
						{#<div class="col-6" name="city" id="city">
																		{{form_widget(formulaire.city)}}
																		</div> #}
						<select class="col-6" name="city" id="city"></select>

					</div>


					<div class="form-group row">

						<label for="select" class="col-4 col-form-label">
							{{form_label(formulaire.location)}}
						</label>
						<div class="col-6" name="location" id="location">
							{{form_widget(formulaire.location)}}
						</div>
					</div>
					<div class="form-group row">
						<label for="select" class="col-4 col-form-label">
							Rue
						</label>
					</div>
					<div class="form-group row">
						<label for="select" class="col-4 col-form-label">
							Code postal
						</label>
					</div>
					<div class="form-group row">
						<label for="select" class="col-4 col-form-label">
							Latitude
						</label>
					</div>
					<div class="form-group row">
						<label for="select" class="col-4 col-form-label">
							Longitude
						</label>
					</div>
				</div>
			</div>
		</fieldset>
		{{form_end(formulaire)}}
	</div>


	{# Ville :
						<select
							name="city" id="city"><!-- <option value="1"> rouge</option> -->
						</select>
						<br>
		Lieu :
						<select name="location" id="location"></select> #}


	{# <script>
			let cities = {};
	let url = '../api/';
	fetch(url).then(res = res.json()).then(data => {
	cities = data
	console.log(data);
	afficherLocation(cities[0].id);
	});

	function afficherCity() { // alimenter select city
	let baliseCity = document.querySelector('#city');
	for (let c of cities) {
	let option = document.createElement('option'); // <option></option>
	option.innerHTML = c.name; // <option>Rennes</option>
	option.setAttribute('value', c.id); // <option value="1">Rennes</option>
	baliseCity.appendChild(option);
	}
	}
	// alimenter select Location
	function afficherLocation(cityId) {
	let baliseLocation = document.querySelector('#location');
	// vider la balise select du Location
	baliseLocation.innerHTML = '';
	// rechercher ts les Locations correspondant à la city
	for (let c of cities) {
	if (c.id == cityId) {
	for (let l of c.locations) {
	let option = document.createElement('option'); // <option></option>
	option.innerHTML = l.name; // <option>rouge</option>
	option.setAttribute('value', l.id); // <option value="1">rouge</option>
	baliseLocation.appendChild(option);
	}
	}
	}
	}
	// condition de depart
	// afficherLocation(data.cities[0].id);

	document.querySelector('#city').onchange = function () {
	let id = document.querySelector('#city').value;
	console.log(id);
	afficherLocation(id);
	}
		</script> #}
{% endblock %}
